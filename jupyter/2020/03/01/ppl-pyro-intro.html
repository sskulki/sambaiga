<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <title>Probabilistic Programming with Pyro | 
  sambaiga
</title>
  

  
  <meta name="description" content="
  
">
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Probabilistic Programming with Pyro | sambaiga</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Probabilistic Programming with Pyro" />
<meta name="author" content="Anthony Faustine" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A tutorial of how to use Pyro for probabilistic models." />
<meta property="og:description" content="A tutorial of how to use Pyro for probabilistic models." />
<link rel="canonical" href="https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html" />
<meta property="og:url" content="https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html" />
<meta property="og:site_name" content="sambaiga" />
<meta property="og:image" content="https://sambaiga.github.io/sambaiga/images/ppl-pyro-intro.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-01T00:00:00-06:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Anthony Faustine"},"description":"A tutorial of how to use Pyro for probabilistic models.","mainEntityOfPage":{"@type":"WebPage","@id":"https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html"},"@type":"BlogPosting","url":"https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html","headline":"Probabilistic Programming with Pyro","dateModified":"2020-03-01T00:00:00-06:00","datePublished":"2020-03-01T00:00:00-06:00","image":"https://sambaiga.github.io/sambaiga/images/ppl-pyro-intro.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/sambaiga/assets/css/style.css">
  <link rel="stylesheet" href="/sambaiga/assets/css/main.css">
  <link rel="canonical" href="https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html"><link type="application/atom+xml" rel="alternate" href="https://sambaiga.github.io/sambaiga/feed.xml" title="sambaiga" />

  

  

  

  <link rel="shortcut icon" type="image/x-icon" href="/sambaiga/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Probabilistic Programming with Pyro | sambaiga</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Probabilistic Programming with Pyro" />
<meta name="author" content="Anthony Faustine" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A tutorial of how to use Pyro for probabilistic models." />
<meta property="og:description" content="A tutorial of how to use Pyro for probabilistic models." />
<link rel="canonical" href="https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html" />
<meta property="og:url" content="https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html" />
<meta property="og:site_name" content="sambaiga" />
<meta property="og:image" content="https://sambaiga.github.io/sambaiga/images/ppl-pyro-intro.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-01T00:00:00-06:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Anthony Faustine"},"description":"A tutorial of how to use Pyro for probabilistic models.","mainEntityOfPage":{"@type":"WebPage","@id":"https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html"},"@type":"BlogPosting","url":"https://sambaiga.github.io/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html","headline":"Probabilistic Programming with Pyro","dateModified":"2020-03-01T00:00:00-06:00","datePublished":"2020-03-01T00:00:00-06:00","image":"https://sambaiga.github.io/sambaiga/images/ppl-pyro-intro.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://sambaiga.github.io/sambaiga/feed.xml" title="sambaiga" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    // remove paragraph tags in rendered toc (happens from notebooks)
    var toctags = document.querySelectorAll(".toc-entry")
    toctags.forEach(e => (e.firstElementChild.innerText = e.firstElementChild.innerText.replace('¬∂', '')))
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/sambaiga/">sambaiga</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/sambaiga/about/">About</a><a class="page-link" href="/sambaiga/blog/">Blog</a><a class="page-link" href="/sambaiga/resources/">Resources</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <div class="wrapper">
    <h1 class="post-title p-name" itemprop="name headline">Probabilistic Programming with Pyro</h1><p class="page-description">A tutorial of how to use Pyro for probabilistic models.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-03-01T00:00:00-06:00" itemprop="datePublished">
        Mar 1, 2020
      </time>
       ‚Ä¢ <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/sambaiga/categories/#jupyter">jupyter</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/sambaiga/sambaiga/tree/master/_notebooks/2020-03-01-ppl-pyro-intro.ipynb" role="button">
<img class="notebook-badge-image" src="/sambaiga/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div><div class="px-2">
    <a href="https://colab.research.google.com/github/sambaiga/sambaiga/blob/master/_notebooks/2020-03-01-ppl-pyro-intro.ipynb">
        <img class="notebook-badge-image" src="/sambaiga/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </div>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Intro-to-Pyro">Intro to Pyro </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Models-and-Probability-distributions">Models and Probability distributions </a></li>
<li class="toc-entry toc-h3"><a href="#Sample-and-Param-statements">Sample and Param statements </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Simple-PPL-model">Simple PPL model </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Generate-data-from-model">Generate data from model </a></li>
<li class="toc-entry toc-h3"><a href="#Learn-parameters-of-the-model-from-data">Learn parameters of the model from data </a></li>
<li class="toc-entry toc-h3"><a href="#Use-model-to-predict-future-observation">Use model to predict future observation </a></li>
<li class="toc-entry toc-h3"><a href="#References">References </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-01-ppl-pyro-intro.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Intro-to-Pyro">
<a class="anchor" href="#Intro-to-Pyro" aria-hidden="true"><span class="octicon octicon-link"></span></a>Intro to Pyro<a class="anchor-link" href="#Intro-to-Pyro"> </a>
</h2>
<p><a href="http://pyro.ai/">Pyro</a> is a universal probabilistic programming language (PPL) written in Python and supported by PyTorch on the backend. It enables flexible and expressive deep probabilistic modeling, unifying the best of modern deep learning and Bayesian modeling.</p>
<h3 id="Models-and-Probability-distributions">
<a class="anchor" href="#Models-and-Probability-distributions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Models and Probability distributions<a class="anchor-link" href="#Models-and-Probability-distributions"> </a>
</h3>
<p><strong>Models</strong> are the basic unit of probabilistic programs in pyro, they represent simplified or abstract descriptions of a process by which data are generated. Models in pyro are expressed as <em>stochastic functions</em> which implies that models can be composed, reused, imported, and serialized just like regular Python callables. <strong>Probability distributions</strong> (pimitive stochastic functions) are important class of models (stochastic functions) used explicitly to compute the probability of the outputs given the inputs.  Pyro uses <a href="https://pytorch.org/docs/master/distributions.html">PyTorch‚Äôs distribution library</a> which contains parameterizable probability distributions and sampling functions. This allows the construction of stochastic computation graphs and stochastic gradient estimators for optimization. Each probability distributions are equipped with several  methods such as:</p>
<ul>
<li>
<strong>prob()</strong>: $\log p(\mathbf{x} \mid \theta ^{*})$</li>
<li>
<strong>mean</strong>: $\mathbb{E}_{p(\mathbf{x} \mid \theta ^{*})}[\mathbf{x}]$</li>
<li>
<strong>sample</strong>: $\mathbf{x}^{*} \sim  {p(\mathbf{x} \mid \theta ^{*})}$</li>
</ul>
<p>You can also create custom distributions using <a href="https://pytorch.org/docs/master/distributions.html#module-torch.distributions.transforms">transforms</a>.</p>
<p><strong>Example 1</strong>: Let define the unit normal distribution $\mathcal{N}(0,1)$, draw  sample $x$ and  compute the log probability according to the distribution.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">pyro</span>
<span class="kn">import</span> <span class="nn">pyro.distributions</span> <span class="k">as</span> <span class="nn">dist</span>
<span class="kn">from</span> <span class="nn">torch.distributions</span> <span class="kn">import</span> <span class="n">constraints</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">pyro</span><span class="o">.</span><span class="n">set_rng_seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>  
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span> 
<span class="n">normal</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> 
<span class="n">x</span> <span class="o">=</span> <span class="n">normal</span><span class="o">.</span><span class="n">rsample</span><span class="p">()</span> <span class="c1"># draw a sample from N(1,1)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"sample"</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
<span class="c1">#To compute the log probability according to the distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"prob"</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">normal</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">())</span> <span class="c1"># score the sample from N(1,1)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>sample -1.3905061483383179
prob 0.15172401070594788
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sample-and-Param-statements">
<a class="anchor" href="#Sample-and-Param-statements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sample and Param statements<a class="anchor-link" href="#Sample-and-Param-statements"> </a>
</h3>
<p>Pyro simplifies the process of sampling from distributions with the use of  <strong>pyro.sample</strong> statement. The <strong>pyro.sample</strong> statement  call stochastic functions or models with a <em>unique name</em> as identifier. Pyro‚Äôs backend uses these names to uniquely identify sample statements and change their behavior at runtime depending on how the enclosing stochastic function is being used. Using <strong>pyro.sample</strong> statement, Pyro can implement  various manipulations that underlie inference algorithms.</p>
<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>

<span class="sd">"""</span>
<span class="sd">name ‚Äì name of sample</span>
<span class="sd">fn ‚Äì distribution class or function</span>
<span class="sd">obs ‚Äì observed datum (optional; should only be used in context of inference) optionally specified in kwargs</span>
<span class="sd">"""</span>
</pre></div>
<p><strong>Example 2</strong>: Let sample from previous normal distribution created in example 1.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>  
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span> 
<span class="n">x</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"my_sample"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(-0.815)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above code generate a random value and records it in the Pyro runtime.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="mi">2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"my_sample"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/miniconda3/lib/python3.7/site-packages/pyro/primitives.py:86: RuntimeWarning: trying to observe a value outside of inference at my_sample
  RuntimeWarning)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above code conditions a stochatsic function on observed data. This should run on inference.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pyro use  <strong>pyro.param</strong> statement to  saves the variable as a parameter in the param store. To interact with the param store. The <strong>pyro.param</strong> statement is used by pyro to  declares a learnable parameter.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="n">init_value</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>

<span class="sd">"""</span>
<span class="sd">name ‚Äì name of param</span>
<span class="sd">init_value ‚Äì initial value</span>
<span class="sd">constraint ‚Äì torch constraint</span>
<span class="sd">"""</span>
</pre></div>
<p><strong>Example 3</strong>: Let create theta parameter</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="s2">"theta"</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">constraint</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">positive</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simple-PPL-model">
<a class="anchor" href="#Simple-PPL-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Simple PPL model<a class="anchor-link" href="#Simple-PPL-model"> </a>
</h2>
<p>Consider the following Poison Regression model
\begin{align}
y(t) &amp;\sim \lambda \exp(-\lambda)\\
\lambda &amp;\sim \exp(c + m(t))\\
c &amp;\sim \mathcal{N}(1, 1)\\
m &amp;\sim \mathcal{N}(0, 1)
\end{align}</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"slope"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"intercept"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"count_</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">dist</span><span class="o">.</span><span class="n">Poisson</span><span class="p">(</span><span class="n">rate</span><span class="p">),</span>
                                <span class="n">obs</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Given a pyro model.
We can</p>
<ol>
<li><strong>Generate data from model</strong></li>
<li><strong>Learn parameters of the model from data</strong></li>
<li>
<strong>Use the model to predict future observation</strong>.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Generate-data-from-model">
<a class="anchor" href="#Generate-data-from-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Generate data from model<a class="anchor-link" href="#Generate-data-from-model"> </a>
</h3>
<p>Running a Pyro model will generate a sample from the prior.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pyro</span><span class="o">.</span><span class="n">set_rng_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># We pass counts = [None, ..., None] to indicate time duration.</span>
<span class="n">true_slope</span><span class="p">,</span> <span class="n">true_intercept</span><span class="p">,</span> <span class="n">true_counts</span> <span class="o">=</span> <span class="n">model</span><span class="p">([</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">true_counts</span><span class="p">)),</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">true_counts</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Learn-parameters-of-the-model-from-data">
<a class="anchor" href="#Learn-parameters-of-the-model-from-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Learn parameters of the model from data<a class="anchor-link" href="#Learn-parameters-of-the-model-from-data"> </a>
</h3>
<p>To learn model parameters we pass the model to an inference algorithm and let the algorithm guess what the model is doing based on observed data. Inference algorithms in Pyro us arbitrary stochastic functions as approximate posterior distributions. that s. These functions are  called guide functions or <strong>guides</strong>  and contains <strong>pyro.sample</strong> and <strong>pyro.param</strong> statement. It is a stochastic function that represents a probability distribution over the latent (unobserved) variables. The guide can be arbitrary python code just like the model, but with a few requirements:</p>
<ol>
<li>All unobserved sample statements that appear in the model appear in the guide. </li>
<li>The guide has the same input signature as the model (i.e. takes the same arguments).</li>
<li>There are no pyro.sample statements with the obs keyword in the guide. These are exclusive to the model.</li>
<li>There are pyro.param statements, which are exclusive to the guide. These provide differentiation for the inputs to the pay_probs sample in the guide vs. the model.</li>
</ol>
<p>For example if the model contains a random variable <em>z_1</em></p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">():</span>
    <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"z_1"</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
<p>then the guide needs to have a matching sample statement</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">guide</span><span class="p">():</span>
    <span class="n">pyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"z_1"</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once a guide has been specified, we can then perform learning and inference which is an optimization problem of maximizing the evidence lower bound (ELBO). The ELBO, is a function of both $\theta$ and $\phi$, defined as an expectation w.r.t. to samples from the guide:</p>
$${\rm ELBO} \equiv \mathbb{E}_{q_{\phi}({\bf z})} \left [
\log p_{\theta}({\bf x}, {\bf z}) - \log q_{\phi}({\bf z})
\right]$$<p>The <strong>SVI</strong> class is unified interface for stochastic variational inference in Pyro. To use this class you need to provide:</p>
<ul>
<li>the model, </li>
<li>the guide, and an </li>
<li>optimizer which is a wrapper a for a PyTorch optimizer as discusseced in below</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyro.infer</span> <span class="kn">import</span> <span class="n">SVI</span><span class="p">,</span> <span class="n">Trace_ELBO</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">Trace_ELBO</span><span class="p">())</span>
</pre></div>
<p>The SVI object provides two methods, <strong>step()</strong> and <strong>evaluate_loss()</strong>,</p>
<ul>
<li>The method step() takes a single gradient step and returns an estimate of the loss (i.e. minus the ELBO). </li>
<li>The method evaluate_loss() returns an estimate of the loss without taking a gradient step.</li>
</ul>
<p>Both of these methods  accept an optional argument: <strong>num_particles</strong>, which denotes the number of samples used to compute the loss  and gradient.</p>
<p>The module <strong>pyro.optim</strong> provides support for optimization in Pyro. In particular it provides <strong>PyroOptim</strong>, which is used to wrap PyTorch optimizers and manage optimizers for dynamically generated parameters. <strong>PyroOptim</strong> takes two arguments:</p>
<ul>
<li>a constructor for PyTorch optimizers <em>optim_constructor</em> and </li>
<li>a specification of the optimizer <em>arguments optim_args</em>
</li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyro.optim</span> <span class="kn">import</span> <span class="n">Adam</span>
<span class="n">adam_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"lr"</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> <span class="s2">"betas"</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">)}</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">(</span><span class="n">adam_params</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thus to learn model parameters we pass the model to an inference algorithm and let the algorithm guess what the model is doing based on observed data (here true_counts).</p>
<p>For the above example we will use Autoguide pyro inference algorithm:</p>
<ul>
<li>AutoLaplaceApproximation:Laplace approximation (quadratic approximation) approximates the posterior logùëù(ùëß|ùë•) by a multivariate normal distribution in the unconstrained space.</li>
<li>Autodelta: This implementation of AutoGuide uses Delta distributions to construct a MAP guide over the entire latent space. </li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pyro.infer.autoguide</span> <span class="kn">import</span> <span class="n">AutoDelta</span>
<span class="kn">from</span> <span class="nn">pyro.infer</span> <span class="kn">import</span> <span class="n">SVI</span><span class="p">,</span> <span class="n">Trace_ELBO</span>
<span class="kn">from</span> <span class="nn">pyro.optim</span> <span class="kn">import</span> <span class="n">Adam</span>

<span class="n">guide</span> <span class="o">=</span> <span class="n">AutoDelta</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">Adam</span><span class="p">({</span><span class="s2">"lr"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}),</span> <span class="n">Trace_ELBO</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">true_counts</span><span class="p">)</span>  <span class="c1"># true_counts is passed as argument to model()</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"loss = </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loss</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loss = 87295.88946688175
loss = 64525.8595520854
loss = 80838.8460238576
loss = 33014.93229973316
loss = 13704.865498423576
loss = 6232.828522503376
loss = 2017.9879159331322
loss = 631.3558134436607
loss = 170.10323333740234
loss = 198.57187271118164
loss = 207.4590385556221
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"true_slope = </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">true_slope</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"true_intercept = </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">true_intercept</span><span class="p">))</span>
<span class="n">guess</span> <span class="o">=</span> <span class="n">guide</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"guess = </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">guess</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>true_slope = 0.15409961342811584
true_intercept = -0.293428897857666
guess = {'slope': tensor(0.147, grad_fn=&lt;ExpandBackward&gt;), 'intercept': tensor(-0.054, grad_fn=&lt;ExpandBackward&gt;)}
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Use-model-to-predict-future-observation">
<a class="anchor" href="#Use-model-to-predict-future-observation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Use model to predict future observation<a class="anchor-link" href="#Use-model-to-predict-future-observation"> </a>
</h3>
<p>A third way to use a Pyro model is to predict new observed data by guiding the model. This uses two of Pyro's effects:</p>
<ul>
<li>trace records guesses made by the guide, and</li>
<li>replay conditions the model on those guesses, allowing the model to generate conditional samples.</li>
</ul>
<p><strong>Traces</strong> are directed graphs whose nodes represent primitive calls or input/output, and whose edges represent conditional dependence relationships between those primitive calls. It return a handler that records the inputs and outputs of primitive calls and their dependencies.</p>
<p>We can record its execution using trace and use the resulting data structure to compute the log-joint probability of all of the sample sites in the execution or extract all parameters.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trace</span> <span class="o">=</span> <span class="n">pyro</span><span class="o">.</span><span class="n">poutine</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">get_trace</span><span class="p">([])</span>
<span class="n">pprint</span><span class="p">({</span>
    <span class="n">name</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">'value'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s1">'value'</span><span class="p">],</span>
        <span class="s1">'prob'</span><span class="p">:</span> <span class="n">props</span><span class="p">[</span><span class="s1">'fn'</span><span class="p">]</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">'value'</span><span class="p">])</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">props</span><span class="p">)</span> <span class="ow">in</span> <span class="n">trace</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">'type'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'sample'</span>
<span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{'intercept': {'prob': tensor(0.250), 'value': tensor(-0.966)},
 'slope': {'prob': tensor(2.818), 'value': tensor(0.083)}}
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">log_prob_sum</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(0.705)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, the trace feature will collect values every time they are sampled with sample and store them with the corresponding string name (that‚Äôs why we give each sample a name). With a little cleanup, we can print out the value and probability of each random variable‚Äôs value, along with the joint probability of the entire trace.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Replay</strong> return a callable that runs the original, reusing the values at sites in trace at those sites in the new trace.  makes sample statements behave as if they had sampled the values at the corresponding sites in the trace</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pyro</span> <span class="kn">import</span> <span class="n">poutine</span>

<span class="k">def</span> <span class="nf">forecast</span><span class="p">(</span><span class="n">forecast_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">true_counts</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">forecast_steps</span>  <span class="c1"># observed data + blanks to fill in</span>
    <span class="n">guide_trace</span> <span class="o">=</span> <span class="n">poutine</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">guide</span><span class="p">)</span><span class="o">.</span><span class="n">get_trace</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">poutine</span><span class="o">.</span><span class="n">replay</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">guide_trace</span><span class="p">)(</span><span class="n">counts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">counts</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now call forecast() multiple times to generate samples.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">full_counts</span> <span class="o">=</span> <span class="n">forecast</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">forecast_counts</span> <span class="o">=</span> <span class="n">full_counts</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">true_counts</span><span class="p">):]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">full_counts</span><span class="p">],</span> <span class="s2">"r"</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">_</span> <span class="k">else</span> <span class="s2">"forecast"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">true_counts</span><span class="p">],</span> <span class="s2">"k-"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"truth"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="References">
<a class="anchor" href="#References" aria-hidden="true"><span class="octicon octicon-link"></span></a>References<a class="anchor-link" href="#References"> </a>
</h3>
<ol>
<li><a href="">Pyro-ducomentation</a></li>
<li><a href="https://github.com/pyro-ppl/sandbox/">PPL models for timeseries forecasting</a></li>
</ol>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="sambaiga/sambaiga"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/sambaiga/jupyter/2020/03/01/ppl-pyro-intro.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/sambaiga/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/sambaiga/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/sambaiga/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          
        </ul>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
